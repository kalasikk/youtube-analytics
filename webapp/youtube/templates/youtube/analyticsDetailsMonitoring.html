{% extends "mainApp/wrapper.html" %}



{% block pageContent %}

  <!-- Page Content -->
  <div class="container">


    <h3>{{channel.title}}</h3>
    <!-- Area Chart -->
    <div class="col-xl-10 col-lg-7">
        <div class="card shadow mb-4" style="width: 1000px;">
          <!-- Card Body -->
          <div class="card-body" style="height: 500px; width: 1000px;">
            <div class="chart-area">
              <canvas id="myLineChart" data-url="{% url 'videos-line-chart' sChannelId=channel.channel_id %}"></canvas>
            </div>
          </div>
        </div>
      </div>
    
  </div>
  <!-- /.container -->

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>
  
  function onInitVideosLineCanvas(aLabels,aData,aVideoTitles){
    const ctx = document.getElementById('myLineChart').getContext('2d');
    const aBackgroundColors = [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)'
              ];
    const aBackgroundBorders = [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)'
              ];
    let aDataset = [];
    for(let i=0;i<aData.length;i++){
      aDataset.push({
              label: aVideoTitles[i],
              data: aData[i],
              fill: false,
              backgroundColor: aBackgroundColors[i],
              borderColor: aBackgroundBorders[i],
              borderWidth: 1
      })
    }
    const myChart = new Chart(ctx, {
      type: 'line',
      data: {
          labels: aLabels,
          datasets: aDataset
      },
      options: {
          responsive: true,
          title:{
            display: true,
            text: 'Videos View Count'
          },
        //   tooltips:{
        //     mode: 'index',
        //     intersect:false
        //   },
        //   hover:{
        //     mode: 'nearest',
        //     intersect: true
        //   },
          scales: {
              xAxes:[{
                  display:true,
                  scaleLabel:{
                      display:true,
                      labelString: 'Day'
                  }
              }],
              yAxes:[{
                  display:true,
                  scaleLabel:{
                      display:true,
                      labelString: 'View'
                  }
              }],
          }
      }
  });
  }

$(function () {
  const $lineChart = $("#myLineChart");
$.ajax({
  url: $lineChart.data("url"),
  success: function (data) {

    console.log(data)
    console.log(Object.keys(data.data))
    onInitVideosLineCanvas(data.labels,Object.values(data.data),Object.keys(data.data))
    }

  })
});


</script>

{% endblock %}